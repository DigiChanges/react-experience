{"version":3,"sources":["../../../../build/babel/plugins/commonjs.ts"],"names":["NextToNextServer","args","commonjs","visitor","Program","exit","path","state","foundModuleExports","traverse","MemberExpression","node","object","name","property","call"],"mappings":"sEACA,gH,mFAEA;AACe,QAASA,CAAAA,gBAAT,CAA0B,GAAGC,IAA7B,CAAmD,CAChE,KAAMC,CAAAA,QAAQ,CAAG,4CAAe,GAAGD,IAAlB,CAAjB,CACA,MAAO,CACLE,OAAO,CAAE,CACPC,OAAO,CAAE,CACPC,IAAI,CAACC,IAAD,CAAgCC,KAAhC,CAAuC,CACzC,GAAIC,CAAAA,kBAAkB,CAAG,KAAzB,CACAF,IAAI,CAACG,QAAL,CAAc,CACZC,gBAAgB,CAACJ,IAAD,CAAY,CAC1B,GAAIA,IAAI,CAACK,IAAL,CAAUC,MAAV,CAAiBC,IAAjB,GAA0B,QAA9B,CAAwC,OACxC,GAAIP,IAAI,CAACK,IAAL,CAAUG,QAAV,CAAmBD,IAAnB,GAA4B,SAAhC,CAA2C,OAC3CL,kBAAkB,CAAG,IAArB,CACD,CALW,CAAd,EAQA,GAAI,CAACA,kBAAL,CAAyB,CACvB,OACD,CAEDN,QAAQ,CAACC,OAAT,CAAiBC,OAAjB,CAAyBC,IAAzB,CAA8BU,IAA9B,CAAmC,IAAnC,CAAyCT,IAAzC,CAA+CC,KAA/C,EACD,CAhBM,CADF,CADJ,CAAP,CAsBD","sourcesContent":["import { NodePath, PluginObj, types } from '@babel/core'\nimport commonjsPlugin from '@babel/plugin-transform-modules-commonjs'\n\n// Rewrite imports using next/<something> to next-server/<something>\nexport default function NextToNextServer(...args: any): PluginObj {\n  const commonjs = commonjsPlugin(...args)\n  return {\n    visitor: {\n      Program: {\n        exit(path: NodePath<types.Program>, state) {\n          let foundModuleExports = false\n          path.traverse({\n            MemberExpression(path: any) {\n              if (path.node.object.name !== 'module') return\n              if (path.node.property.name !== 'exports') return\n              foundModuleExports = true\n            },\n          })\n\n          if (!foundModuleExports) {\n            return\n          }\n\n          commonjs.visitor.Program.exit.call(this, path, state)\n        },\n      },\n    },\n  }\n}\n"]}